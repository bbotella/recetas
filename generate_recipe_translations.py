#!/usr/bin/env python3
"""
Script to generate English translations for all recipes
"""

import os
import sys
from database import (init_database, get_all_recipes, save_recipe_translation, 
                     get_recipe_translation)

# Translation dictionaries for common ingredients and terms
INGREDIENT_TRANSLATIONS = {
    # Ingredients
    'huevos': 'eggs',
    'harina': 'flour',
    'azúcar': 'sugar',
    'leche': 'milk',
    'mantequilla': 'butter',
    'aceite': 'oil',
    'sal': 'salt',
    'pimienta': 'pepper',
    'cebolla': 'onion',
    'ajo': 'garlic',
    'tomate': 'tomato',
    'patata': 'potato',
    'patatas': 'potatoes',
    'pollo': 'chicken',
    'carne': 'meat',
    'pescado': 'fish',
    'arroz': 'rice',
    'pasta': 'pasta',
    'queso': 'cheese',
    'jamón': 'ham',
    'chorizo': 'chorizo',
    'pimiento': 'pepper',
    'zanahoria': 'carrot',
    'apio': 'celery',
    'perejil': 'parsley',
    'limón': 'lemon',
    'naranja': 'orange',
    'vino': 'wine',
    'vinagre': 'vinegar',
    'pan': 'bread',
    'agua': 'water',
    'caldo': 'broth',
    'nata': 'cream',
    'yogur': 'yogurt',
    'chocolate': 'chocolate',
    'vainilla': 'vanilla',
    'canela': 'cinnamon',
    'nuez': 'walnut',
    'almendra': 'almond',
    'piñón': 'pine nut',
    'pasas': 'raisins',
    'miel': 'honey',
    'mermelada': 'jam',
    'gelatina': 'gelatin',
    'levadura': 'yeast',
    'bicarbonato': 'baking soda',
    'polvo de hornear': 'baking powder',
    'maicena': 'cornstarch',
    'brandy': 'brandy',
    'licor': 'liqueur',
    'ron': 'rum',
    'coñac': 'cognac',
    'jerez': 'sherry',
    'moscatel': 'muscatel',
    'anís': 'anise',
    'turrón': 'nougat',
    'galletas': 'cookies',
    'bizcocho': 'sponge cake',
    'masa': 'dough',
    'crema': 'cream',
    'natillas': 'custard',
    'flan': 'flan',
    'helado': 'ice cream',
    'sorbete': 'sorbet',
    'granizado': 'slush',
    'horchata': 'horchata',
    'sangría': 'sangria',
    'gazpacho': 'gazpacho',
    'paella': 'paella',
    'tortilla': 'tortilla',
    'empanada': 'empanada',
    'croqueta': 'croquette',
    'albóndiga': 'meatball',
    'chorizo': 'chorizo',
    'morcilla': 'blood sausage',
    'jamón serrano': 'serrano ham',
    'jamón ibérico': 'iberico ham',
    'queso manchego': 'manchego cheese',
    'aceitunas': 'olives',
    'alcaparras': 'capers',
    'pimentón': 'paprika',
    'azafrán': 'saffron',
    'laurel': 'bay leaf',
    'romero': 'rosemary',
    'tomillo': 'thyme',
    'orégano': 'oregano',
    'albahaca': 'basil',
    'cilantro': 'cilantro',
    'menta': 'mint',
    'hierbabuena': 'spearmint',
    'eneldo': 'dill',
    'comino': 'cumin',
    'pimentón dulce': 'sweet paprika',
    'pimentón picante': 'hot paprika',
    'guindilla': 'chili pepper',
    'cayena': 'cayenne',
    'mostaza': 'mustard',
    'mayonesa': 'mayonnaise',
    'alioli': 'aioli',
    'salsa': 'sauce',
    'sofrito': 'sofrito',
    'picada': 'picada',
    'majada': 'crushed mixture',
    'refrito': 'sautéed mixture',
    'guiso': 'stew',
    'cocido': 'boiled',
    'asado': 'roasted',
    'frito': 'fried',
    'plancha': 'grilled',
    'vapor': 'steamed',
    'horno': 'oven',
    'fuego': 'fire',
    'llama': 'flame',
    'hervir': 'boil',
    'cocer': 'cook',
    'freír': 'fry',
    'asar': 'roast',
    'hornear': 'bake',
    'saltear': 'sauté',
    'dorar': 'brown',
    'glasear': 'glaze',
    'batir': 'beat',
    'mezclar': 'mix',
    'remover': 'stir',
    'amasar': 'knead',
    'tamizar': 'sift',
    'picar': 'chop',
    'trocear': 'cut into pieces',
    'cortar': 'cut',
    'pelar': 'peel',
    'rallar': 'grate',
    'exprimir': 'squeeze',
    'colar': 'strain',
    'escurrir': 'drain',
    'enfriar': 'cool',
    'calentar': 'heat',
    'templar': 'warm',
    'derretir': 'melt',
    'disolver': 'dissolve',
    'incorporar': 'incorporate',
    'añadir': 'add',
    'agregar': 'add',
    'verter': 'pour',
    'rociar': 'sprinkle',
    'espolvorear': 'dust',
    'untar': 'spread',
    'pintar': 'brush',
    'adornar': 'garnish',
    'decorar': 'decorate',
    'servir': 'serve',
    'presentar': 'present',
    'acompañar': 'accompany',
    'condimentar': 'season',
    'aliñar': 'dress',
    'sazonar': 'season',
    'marinar': 'marinate',
    'macerar': 'macerate',
    'reposar': 'rest',
    'cuajar': 'set',
    'solidificar': 'solidify',
    'espesar': 'thicken',
    'reducir': 'reduce',
    'concentrar': 'concentrate',
    'clarificar': 'clarify',
    'filtrar': 'filter',
    'prensar': 'press',
    'moldear': 'mold',
    'formar': 'form',
    'dar forma': 'shape',
    'extender': 'spread',
    'estirar': 'stretch',
    'enrollar': 'roll',
    'plegar': 'fold',
    'cubrir': 'cover',
    'tapar': 'cover',
    'envolver': 'wrap',
    'forrar': 'line',
    'engrasar': 'grease',
    'enharinar': 'flour',
    'desmoldar': 'unmold',
    'voltear': 'turn over',
    'dar la vuelta': 'turn over',
    'girar': 'turn',
    'mover': 'move',
    'agitar': 'shake',
    'sacudir': 'shake',
    'golpear': 'hit',
    'machacar': 'crush',
    'triturar': 'grind',
    'moler': 'grind',
    'pulverizar': 'pulverize',
    'desmenuzar': 'crumble',
    'deshacer': 'break up',
    'separar': 'separate',
    'dividir': 'divide',
    'partir': 'break',
    'quebrar': 'break',
    'romper': 'break',
    'abrir': 'open',
    'cerrar': 'close',
    'sellar': 'seal',
    'atar': 'tie',
    'sujetar': 'hold',
    'sostener': 'hold',
    'levantar': 'lift',
    'bajar': 'lower',
    'subir': 'raise',
    'hundir': 'sink',
    'flotar': 'float',
    'sumergir': 'submerge',
    'remojar': 'soak',
    'hidratar': 'hydrate',
    'humedecer': 'moisten',
    'secar': 'dry',
    'escurrir': 'drain',
    'limpiar': 'clean',
    'lavar': 'wash',
    'aclarar': 'rinse',
    'frotar': 'rub',
    'cepillar': 'brush',
    'raspar': 'scrape',
    'quitar': 'remove',
    'eliminar': 'eliminate',
    'descartar': 'discard',
    'tirar': 'throw away',
    'guardar': 'save',
    'conservar': 'preserve',
    'mantener': 'maintain',
    'almacenar': 'store',
    'refrigerar': 'refrigerate',
    'congelar': 'freeze',
    'descongelar': 'defrost',
    'deshelar': 'thaw',
    'temporal': 'temporary',
    'permanente': 'permanent',
    'fresco': 'fresh',
    'seco': 'dry',
    'húmedo': 'moist',
    'mojado': 'wet',
    'caliente': 'hot',
    'tibio': 'warm',
    'frío': 'cold',
    'helado': 'frozen',
    'crudo': 'raw',
    'cocido': 'cooked',
    'hecho': 'done',
    'listo': 'ready',
    'preparado': 'prepared',
    'terminado': 'finished',
    'completo': 'complete',
    'perfecto': 'perfect',
    'correcto': 'correct',
    'adecuado': 'adequate',
    'suficiente': 'sufficient',
    'abundante': 'abundant',
    'escaso': 'scarce',
    'poco': 'little',
    'mucho': 'much',
    'bastante': 'enough',
    'demasiado': 'too much',
    'exacto': 'exact',
    'aproximado': 'approximate',
    'más o menos': 'more or less',
    'alrededor': 'around',
    'cerca': 'close',
    'lejos': 'far',
    'dentro': 'inside',
    'fuera': 'outside',
    'encima': 'on top',
    'debajo': 'underneath',
    'arriba': 'above',
    'abajo': 'below',
    'delante': 'in front',
    'detrás': 'behind',
    'izquierda': 'left',
    'derecha': 'right',
    'centro': 'center',
    'medio': 'middle',
    'lateral': 'side',
    'esquina': 'corner',
    'borde': 'edge',
    'orilla': 'rim',
    'superficie': 'surface',
    'fondo': 'bottom',
    'base': 'base',
    'parte': 'part',
    'trozo': 'piece',
    'pedazo': 'piece',
    'porción': 'portion',
    'ración': 'serving',
    'cantidad': 'amount',
    'medida': 'measure',
    'peso': 'weight',
    'volumen': 'volume',
    'tamaño': 'size',
    'forma': 'shape',
    'color': 'color',
    'sabor': 'flavor',
    'olor': 'smell',
    'aroma': 'aroma',
    'textura': 'texture',
    'consistencia': 'consistency',
    'densidad': 'density',
    'grosor': 'thickness',
    'finura': 'fineness',
    'suavidad': 'smoothness',
    'rugosidad': 'roughness',
    'dureza': 'hardness',
    'blandura': 'softness',
    'flexibilidad': 'flexibility',
    'rigidez': 'rigidity',
    'elasticidad': 'elasticity',
    'viscosidad': 'viscosity',
    'fluidez': 'fluidity',
    'cremosidad': 'creaminess',
    'jugosidad': 'juiciness',
    'sequedad': 'dryness',
    'humedad': 'moisture',
    'frescura': 'freshness',
    'madurez': 'ripeness',
    'punto': 'point',
    'grado': 'degree',
    'nivel': 'level',
    'intensidad': 'intensity',
    'fuerza': 'strength',
    'potencia': 'power',
    'energía': 'energy',
    'vigor': 'vigor',
    'vitalidad': 'vitality',
    'vida': 'life',
    'muerte': 'death',
    'tiempo': 'time',
    'momento': 'moment',
    'instante': 'instant',
    'segundo': 'second',
    'minuto': 'minute',
    'hora': 'hour',
    'día': 'day',
    'semana': 'week',
    'mes': 'month',
    'año': 'year',
    'mañana': 'morning',
    'tarde': 'afternoon',
    'noche': 'night',
    'madrugada': 'dawn',
    'amanecer': 'sunrise',
    'mediodía': 'noon',
    'atardecer': 'sunset',
    'anochecer': 'nightfall',
    'primavera': 'spring',
    'verano': 'summer',
    'otoño': 'autumn',
    'invierno': 'winter',
    'estación': 'season',
    'clima': 'weather',
    'temperatura': 'temperature',
    'calor': 'heat',
    'frío': 'cold',
    'viento': 'wind',
    'lluvia': 'rain',
    'nieve': 'snow',
    'sol': 'sun',
    'luna': 'moon',
    'estrella': 'star',
    'cielo': 'sky',
    'tierra': 'earth',
    'mar': 'sea',
    'río': 'river',
    'lago': 'lake',
    'montaña': 'mountain',
    'valle': 'valley',
    'campo': 'field',
    'ciudad': 'city',
    'pueblo': 'town',
    'aldea': 'village',
    'casa': 'house',
    'hogar': 'home',
    'cocina': 'kitchen',
    'comedor': 'dining room',
    'mesa': 'table',
    'silla': 'chair',
    'plato': 'plate',
    'vaso': 'glass',
    'copa': 'cup',
    'taza': 'mug',
    'cuenco': 'bowl',
    'fuente': 'serving dish',
    'bandeja': 'tray',
    'cacerola': 'pot',
    'sartén': 'pan',
    'olla': 'pot',
    'cazuela': 'casserole',
    'recipiente': 'container',
    'envase': 'packaging',
    'frasco': 'jar',
    'botella': 'bottle',
    'lata': 'can',
    'caja': 'box',
    'bolsa': 'bag',
    'paquete': 'package',
    'sobre': 'envelope',
    'papel': 'paper',
    'cartón': 'cardboard',
    'plástico': 'plastic',
    'vidrio': 'glass',
    'metal': 'metal',
    'madera': 'wood',
    'piedra': 'stone',
    'barro': 'clay',
    'cerámica': 'ceramic',
    'porcelana': 'porcelain',
    'cristal': 'crystal',
    'hierro': 'iron',
    'acero': 'steel',
    'aluminio': 'aluminum',
    'cobre': 'copper',
    'plata': 'silver',
    'oro': 'gold',
    'diamante': 'diamond',
    'perla': 'pearl',
    'rubí': 'ruby',
    'esmeralda': 'emerald',
    'zafiro': 'sapphire',
    'topacio': 'topaz',
    'amatista': 'amethyst',
    'cuarzo': 'quartz',
    'granito': 'granite',
    'mármol': 'marble',
    'pizarra': 'slate',
    'arena': 'sand',
    'grava': 'gravel',
    'roca': 'rock',
    'mineral': 'mineral',
    'cristal': 'crystal',
    'polvo': 'powder',
    'ceniza': 'ash',
    'humo': 'smoke',
    'vapor': 'steam',
    'gas': 'gas',
    'líquido': 'liquid',
    'sólido': 'solid',
    'materia': 'matter',
    'sustancia': 'substance',
    'elemento': 'element',
    'compuesto': 'compound',
    'mezcla': 'mixture',
    'solución': 'solution',
    'emulsión': 'emulsion',
    'suspensión': 'suspension',
    'espuma': 'foam',
    'gel': 'gel',
    'pasta': 'paste',
    'crema': 'cream',
    'mantequilla': 'butter',
    'margarina': 'margarine',
    'aceite': 'oil',
    'grasa': 'fat',
    'manteca': 'lard',
    'sebo': 'tallow',
    'cera': 'wax',
    'parafina': 'paraffin',
    'vaselina': 'vaseline',
    'glicerina': 'glycerin',
    'alcohol': 'alcohol',
    'éter': 'ether',
    'acetona': 'acetone',
    'gasolina': 'gasoline',
    'petróleo': 'oil',
    'carbón': 'coal',
    'madera': 'wood',
    'leña': 'firewood',
    'papel': 'paper',
    'cartón': 'cardboard',
    'tela': 'fabric',
    'algodón': 'cotton',
    'lana': 'wool',
    'seda': 'silk',
    'lino': 'linen',
    'cáñamo': 'hemp',
    'yute': 'jute',
    'nylon': 'nylon',
    'poliéster': 'polyester',
    'acrílico': 'acrylic',
    'goma': 'rubber',
    'caucho': 'rubber',
    'látex': 'latex',
    'cuero': 'leather',
    'piel': 'skin',
    'pelo': 'hair',
    'pluma': 'feather',
    'hueso': 'bone',
    'marfil': 'ivory',
    'cuerno': 'horn',
    'concha': 'shell',
    'coral': 'coral',
    'esponja': 'sponge'
}

CATEGORY_TRANSLATIONS = {
    'Postres': 'Desserts',
    'Pollo': 'Chicken',
    'Pescado': 'Fish',
    'Carnes': 'Meat',
    'Bebidas': 'Beverages',
    'Verduras': 'Vegetables',
    'Aperitivos': 'Appetizers',
    'Otros': 'Others'
}

def translate_text(text, translations_dict):
    """Simple translation using dictionary replacement."""
    if not text:
        return text
    
    translated = text
    for spanish, english in translations_dict.items():
        # Replace whole words (case insensitive)
        import re
        pattern = r'\b' + re.escape(spanish) + r'\b'
        translated = re.sub(pattern, english, translated, flags=re.IGNORECASE)
    
    return translated

def translate_recipe_content(recipe):
    """Translate recipe content to English."""
    # Simple translation of common ingredients and terms
    translated_title = translate_text(recipe['title'], INGREDIENT_TRANSLATIONS)
    translated_description = translate_text(recipe['description'], INGREDIENT_TRANSLATIONS)
    translated_ingredients = translate_text(recipe['ingredients'], INGREDIENT_TRANSLATIONS)
    translated_instructions = translate_text(recipe['instructions'], INGREDIENT_TRANSLATIONS)
    translated_category = CATEGORY_TRANSLATIONS.get(recipe['category'], recipe['category'])
    
    return {
        'title': translated_title,
        'description': translated_description,
        'ingredients': translated_ingredients,
        'instructions': translated_instructions,
        'category': translated_category
    }

def generate_recipe_translations():
    """Generate English translations for all recipes."""
    print("Initializing database...")
    init_database()
    
    print("Getting all recipes...")
    recipes = get_all_recipes()
    
    print(f"Found {len(recipes)} recipes to translate.")
    
    translated_count = 0
    updated_count = 0
    
    for recipe in recipes:
        print(f"Processing recipe: {recipe['title']}")
        
        # Check if translation already exists
        existing_translation = get_recipe_translation(recipe['id'], 'en')
        
        if existing_translation:
            print(f"  - Translation already exists, skipping...")
            continue
        
        # Generate translation
        translation = translate_recipe_content(recipe)
        
        # Save translation
        save_recipe_translation(
            recipe['id'],
            'en',
            translation['title'],
            translation['description'],
            translation['ingredients'],
            translation['instructions'],
            translation['category']
        )
        
        translated_count += 1
        print(f"  - Translated successfully")
    
    print(f"\nTranslation completed!")
    print(f"  - Recipes translated: {translated_count}")
    print(f"  - Total recipes: {len(recipes)}")

if __name__ == "__main__":
    generate_recipe_translations()